<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>KC Optical Engine v2.0</title>

<style>
body { font-family: Arial, "Microsoft JhengHei"; margin: 20px; }
.block { border:1px solid #ccc; padding:12px; margin:14px 0; border-radius:6px; }
h1 { color:#002244; }
h2 { color:#003366; margin-bottom:6px; }
input { margin:4px 0; width:120px; }
button {
    padding:8px 20px;
    background:#004b8d;
    color:white;
    border:none;
    border-radius:4px;
    cursor:pointer;
}
button:hover { background:#0066c0; }
#output {
    font-size:22px;
    font-weight:bold;
    color:#aa0000;
    margin-top:10px;
}
</style>

<script>
function compute(){

  // --- Input parameters ---
  let L = parseFloat(document.getElementById('L_led').value);
  let G = parseFloat(document.getElementById('G_dbef').value);
  let phi = parseFloat(document.getElementById('phi').value) * Math.PI / 180;  // deg → rad
  let Ploss = parseFloat(document.getElementById('P_loss').value);

  let Th = parseFloat(document.getElementById('T_heater').value);
  let Toca = parseFloat(document.getElementById('T_oca').value);

  let Tpd = parseFloat(document.getElementById('T_pol_down').value);
  let Tlc = parseFloat(document.getElementById('T_lc').value);
  let Tpu = parseFloat(document.getElementById('T_pol_up').value);

  let Gbef = parseFloat(document.getElementById('G_bef').value);

  // --- Optical Engine Full Model ---
  // L_out = L_led × G_dbef × cos²(Δφ) × (1 − P_loss) × 
  //         T_heater × T_oca × T_pol_down × T_lc × T_pol_up × G_bef

  let Lout =
      L *
      G *
      Math.cos(phi)**2 *
      (1 - Ploss) *
      Th * Toca *
      Tpd * Tlc * Tpu *
      Gbef;

  document.getElementById('output').innerText =
      Lout.toFixed(2) + " nits";
}
</script>

</head>

<body>

<h1>KC Optical Engine v2.0</h1>
<p>全光學堆疊模型：LED → DBEF → Heater → LCD → BEF</p>

<!-- DBEF Section -->
<div class="block">
<h2>DBEF Section</h2>
LED Brightness (nits):<br>
<input id="L_led" value="1150"><br>

DBEF Gain:<br>
<input id="G_dbef" value="1.12"><br>

Δφ (deg) – DBEF / Heater axis misalignment:<br>
<input id="phi" value="0"><br>

P-loss (0–0.3) – Heater polarization damage:<br>
<input id="P_loss" value="0.05"><br>
</div>

<!-- Heater -->
<div class="block">
<h2>Heater Section</h2>
Heater Transmission:<br>
<input id="T_heater" value="0.83"><br>

OCA Transmission:<br>
<input id="T_oca" value="0.98"><br>
</div>

<!-- LCD -->
<div class="block">
<h2>LCD Section</h2>
Down Polarizer Transmission:<br>
<input id="T_pol_down" value="0.38"><br>

LC Cell Transmission:<br>
<input id="T_lc" value="0.92"><br>

Up Polarizer Transmission:<br>
<input id="T_pol_up" value="0.38"><br>
</div>

<!-- BEF -->
<div class="block">
<h2>BEF Section</h2>
BEF Gain:<br>
<input id="G_bef" value="1.6"><br>
</div>

<button onclick="compute()">Compute</button>

<h2>Output:</h2>
<div id="output">--</div>

</body>
</html>
